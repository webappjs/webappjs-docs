/**
 * webappjs is a single-page application (SPA) framework that emphasizes the separation of template and interaction, based on the features of ECMAScript 5.
 * Copyright (c) 1992-2024, xinghanjiaozhu. (MIT Licensed)
 * email <a@astarhan.net> 
 * qq <1102119280>
 * https://github.com/webappjs
 */
!function(n,o,t){"use strict";function e(){if(o.currentScript)return o.currentScript.src;for(var t=o.scripts,e=null,i=t.length-1;0<=i;i--)if("interactive"===t[i].readyState){e=t[i].src;break}return e||n.location.href}function p(t){return"function"!=typeof String.prototype.trim?t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):t.trim()}function s(t){return!("number"!=typeof t&&"string"!=typeof t||isNaN(t)||null===t)&&/^[0-9]+$|^[0-9]+\.[0-9]+$/.test(t)}function v(t){return"string"==typeof t}function a(t){t=String(t);return""===t||/^[\s\uFEFF\xA0]+$/.test(t)}function m(t){return"string"==typeof t?t:"number"==typeof t?String(t):""}function P(t){var e=!0;if(t&&t instanceof Object)for(var i in t)if(t.hasOwnProperty(i)){e=!1;break}return e}function R(t,e){if(t&&"object"==typeof t)if(t instanceof Array)for(var i=0;i<t.length;i++)t[i]!==t&&("undefined"==typeof t[i]&&(t[i]=undefined),e(i,t[i]));else for(var i in t)t[i]!==t&&t.hasOwnProperty(i)&&e(i,t[i])}function g(t,e){if("function"==typeof e)return e(t);i="string"==typeof e?e:"%/&=?[] ";for(var i,n="",r=0;r<t.length;r++){var s=t.at(r);n+=s=0<=i.indexOf(s)?encodeURIComponent(s):s}return n}function l(t){return decodeURIComponent(t)}function q(t,e){var i="";if(t&&"object"==typeof t){for(var n in t)if(t[n]!==t&&t.hasOwnProperty(n)){var r,s=function o(t,e){var i=new Array;if(t&&"object"==typeof t){for(var n in t)if(t[n]!==t&&t.hasOwnProperty(n)){var r,s=o(t[n],e);for(r in s)n=g(n,e),i.push("["+n+"]"+s[r])}}else t="="+g(m(t),e),i.push(t);return i}(t[n],e);for(r in s)i+=(n=g(n,e))+s[r]+"&"}""!==i&&(i=i.slice(0,i.length-1))}return i}function z(t){for(var e=m(t).replace(/^(\?|\#){0,}/g,"").split("&"),i=new Object,n=0;n<e.length;n++){var r,s,o=e[n].split("="),a=o.shift(),o=o.join("=");a.match(/\[([^\[\]]*){0,}\]$/g)?""!==(s=(r=a.split("[")).shift())&&(i[s=l(s)]="undefined"!=typeof i[s]?i[s]:new Object,i[s]=function h(t,e,i){var n=e.shift();var r=n.replace(/\]$/g,"");n=/^\d$/g;r=(r.match(n)?parseInt:l)(r);var s=0;for(;""===r&&0!==r;){if("undefined"==typeof t[s]){r=s;break}s++}e.length?(t[r]="undefined"!=typeof t[r]?t[r]:new Object,t[r]=h(t[r],e,i)):t[r]=i;return t}(i[s],r,l(o))):i[l(a)]=l(o)}return i}function Q(t){var e;return"string"!=typeof t?t:((e=o.createElement("DIV")).innerText?e.innerText=t:e.textContent=t,e.innerHTML)}function F(t){var e;return"string"!=typeof t?t:((e=o.createElement("DIV")).innerHTML=t,e.innerText||e.textContent)}function B(t,e,i){"function"==typeof t.addEventListener?(t.addEventListener(e,i,!1),t.removeEventListener(e,i,!0)):"function"==typeof t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i}var c={template:{"model-selector-deploy":"Model Selector “${1}” 声明定义 “${2}” 失败！ \n\n >>> Message:\n ${3} \n\n >>> Statement:${4}\n${5} \n\n >>> Template:${6}\n${7}\n","statement-syntax-elseif-else":"“${1}” 命令语法错误, “$elseif” 或 “$else” 命令之前的同级节点必须存在 “$if”, 而 “$else” 命令之前的同级节点必须存在 “$elseif” 或 “$if” 命令","render-selector":"渲染出错, 选择器是一个抽象节点树, 未找到可渲染有效节点","render-for-id":"渲染出错, “${1}” 循环主键重复, 循环主键必须是当前循环主键列表中的唯一值"},make:function(){if(!arguments.length)return"";var t=arguments[0];if(null===(r=this.template[t]||null))return"<<<<<框架语言编码["+t+"]异常>>>>>";if("string"==typeof r&&!a(r))for(var e=new RegExp("\\$\\{(\\d+)\\}","g");;){var i=e.exec(r);if(!i)break;var n=arguments[i[1]],r=r.replace(i[0],v(n)||s(n)?n:"{???}")}return r},define:function(t){for(var e in t)v(t[e])&&(this.template[e]=t[e])}},i={enumerable:{writable:!1,enumerable:!0,configurable:!1},readonly:{writable:!1,enumerable:!1,configurable:!1},writable:{writable:!0,enumerable:!1,configurable:!1}},K={create:function(t){var e,i=-1;return"undefined"!=typeof this.autoIncrement[t]&&(e=this.autoIncrement[t],i=this.formatExponential(t,e),e>=this.maxSafeInteger?(this.autoIncrement[t]=0,this.increaseExponential(t)):this.autoIncrement[t]++),i},maxSafeInteger:Number.MAX_SAFE_INTEGER,type:{observerSubscribe:"observerSubscribe"},autoIncrement:{observerSubscribe:0},exponential:new Object,increaseExponential:function(t){var e;"undefined"==typeof this.exponential[t]?this.exponential[t]=[0]:(t=this.exponential[t])[e=t.length-1]>=this.maxSafeInteger?t.push(0):t[e]++},formatExponential:function(t,e){return"undefined"==typeof this.exponential[t]?e:this.exponential[t].join(".")+"."+String(e)}};function h(t,e){this.href="string"==typeof t?t:n.location.href,this.base="string"==typeof e?new h(e):e instanceof h?e:null,this.protocol="",this.user="",this.password="",this.domain="",this.port=-1,this.path=new Array,this.query=new Object,this.hash="",this.file=!1,this.root=!1,new W(this)}function W(t){this.url=t,this.buffer=p(t.href),this.protocol(),this.path(),this.query(),this.hash()}h.prototype={constructor:h,stringify:function(t,e){if("string"==typeof t)for(var i=!1,n=!1,r=!1,s=!1,o=!1,a=!1,h=!1,l=p(t).toLowerCase().split(/\s{0,}\,\s{0,}/),u=0;u<l.length;u++){var d=/^(\!)?([^\!]+)/i.exec(l[u]);if(d){var c=d[2],f=!Boolean(d[1]);switch(c){case"all":h=a=o=s=r=n=i=f;break;case"origin":s=r=i=f;break;case"host":s=r=f;break;case"protocol":i=f;break;case"account":n=f;break;case"domain":r=f;break;case"port":s=f;break;case"path":o=f;break;case"query":a=f;break;case"hash":h=f}}}else i=!0,n=!0,r=!0,s=!0,o=!0,a=!0,h=!0;t="";if(i&&""!==this.protocol&&(t=t+this.protocol+"://"),n&&(""!==this.user&&(t=t+this.user+":"),""!==this.password)&&(t=t+this.password+"@"),r&&""!==this.domain&&(t+=this.domain),s&&0<=this.port&&(t=t+":"+this.port),o)if(this.path.length){for(var v="",u=0;u<this.path.length;u++)""!=v&&(v+="/"),v+=g(this.path[u],e);this.file||(v+="/"),""==t&&!this.root||(t+="/"),t+=v}else this.root&&(t+="/");return""===t||!a&&!h||o&&(0!=this.path.length||this.root)||(t+="/"),a&&!P(this.query)&&(t=(t+="?")+q(this.query,e)),h&&(t+=this.hash),t}},W.prototype={constructor:W,protocol:function(){/^\/\/([^\/]+)/.test(this.buffer)&&(this.buffer=window.location.protocol+this.buffer);var t,e=/^([^\:\/]+)\:\/\/([^\/\?\#]{0,})/.exec(this.buffer);e&&(this.buffer=this.buffer.slice(e.index+e[0].length),this.url.protocol=e[1],"undefined"!=typeof e[2])&&((t=/^([^\:\@]+)\:([^\@]+)\@([^\:]+)[\:]?(.*)?/.exec(e[2]))?(this.url.user=t[1],this.url.password=t[2],this.url.domain=t[3],"undefined"!=typeof t[4]&&(this.url.port=parseInt(t[4]))):(t=/^([^\:]+)[\:]?(.*)?/.exec(e[2]))&&(this.url.domain=t[1],"undefined"!=typeof t[2])&&(this.url.port=parseInt(t[2])))},path:function(){var t=/^([^\?\#]+)/.exec(this.buffer);if(t){this.buffer=this.buffer.slice(t.index+t[0].length),t[1].match(/^\//g)?this.url.root=!0:this.url.root=!1,t[1].match(/\/$/g)?this.url.file=!1:this.url.file=!0,t[1]=t[1].replace(/(^\/)|(\/$)/g,"");var e=""!==t[1]?t[1].split("/"):new Array,i=this.base();if(i instanceof Array){for(var n=0;n<e.length;n++){var r=e[n];"."!==r&&(".."===r?i.length&&i.pop():i.push(l(r)))}this.url.path=i}else if(e.length)for(n=0;n<e.length;n++)this.url.path.push(l(e[n]))}},query:function(){var t=/^([^\#]+)/.exec(this.buffer);t&&(this.buffer=this.buffer.slice(t.index+t[0].length),this.url.query=z(t[1]))},hash:function(){/^\#/.test(this.buffer)&&(this.url.hash=this.buffer)},base:function(){if(this.url.root||!this.url.base||!this.url.base.root)return null;this.url.protocol=this.url.base.protocol,this.url.user=this.url.base.user,this.url.password=this.url.base.password,this.url.domain=this.url.base.domain,this.url.port=this.url.base.port,this.url.root=!0;var t=new Array;if(this.url.base.path.length){for(var e=0;e<this.url.base.path.length;e++)t.push(this.url.base.path[e]);this.url.base.file&&t.pop()}return t}};var D="element",J="singleElement",G="comment",_="text",X="code";function u(t){this.type=t.type||"",this.tag=t.tag||"",this.content=t.content||"",this.failed=!1,this.removed=!1,this.cleared=!1,this.view=t.view||null,this.parent=t.parent instanceof u?t.parent:null,this.children=new d,this.templateLocation=t.templateLocation instanceof Array?t.templateLocation:[-1,-1],this.node=null,this.attribute=new Object,this.statement=null,this.buffer=new Object,this.eventListener=null,this.renderListener=null,this.renderSubscriber=null,this.renderSelector=null,this.renderActive=!0,this.renderStatus=!1,this.renderView=null}u.prototype={constructor:u,stringify:function(){if(this.isText()||this.isCode())return this.content;if(this.isComment())return"\x3c!--"+this.content+"--\x3e";var t,e="";for(t in this.attribute)e+=" "+t,""!==this.attribute[t]&&(e+='="'+this.attribute[t].replace(/(\\|\")/g,"\\$1")+'"');if(this.isSingleElement())return"<"+this.tag+e+"/>";for(var i="<"+this.tag+e+">",n=0;n<this.children.length;n++)i+=this.children[n].stringify();return i+="</"+this.tag+">"},createNode:function(){if(this.isComment())this.node=o.createComment(this.content);else if(this.isText())this.node=o.createTextNode(F(this.content));else if(this.isCode())this.node=o.createTextNode(this.content);else if(this.isElement()){var t,e;for(e in this.isElementNS()?(t="string"==typeof this.attribute.xmlns?this.attribute.xmlns:"http://www.w3.org/2000/svg",this.node=o.createElementNS(t,this.tag)):this.node=o.createElement(this.tag),this.attribute)if(0!==e.indexOf("--"))try{this.node.setAttribute(e,this.attribute[e])}catch(i){console.warn(i,this.stringify())}}},isElement:function(){return Boolean(this.type===D||this.type===J)},isSingleElement:function(){return this.type===J},isComment:function(){return this.type===G},isText:function(){return this.type===_},isCode:function(){return this.type===X},isElementNS:function(){return"svg"===this.tag.toLowerCase()&&this.isElement()},isViewSignal:function(){return!(!this.view.signalActive||this.view.parent&&!this.view.parent.signalActive)},isViewRender:function(){return!(!this.view.renderActive||this.view.parent&&!this.view.parent.renderActive||this.view.renderVirtualNode&&!this.view.renderVirtualNode.view.renderActive)},updateView:function(t){this.view=t,this.children.updateView(t)},isRender:function(){return!this.removed&&!this.failed&&this.renderActive},querySibling:function(){return this.parent?this.parent.children:this.view.virtualTree},checkSibling:function(){var t=this.querySibling();this.renderStatus||(t.renderStatus=!1)},checkHeartbeat:function(t){var e=!this.removed&&!this.failed;if(e)for(var i,n=new Array,r=this.parent||this.view.renderVirtualNode;r instanceof u&&!(0<=n.indexOf(r));){if(n.push(r),r.removed){this.remove(),e=!1;break}if(r.failed){this.clear(),e=!1;break}if(r.cleared||!r.renderActive||!r.renderStatus){r===this.parent?this.renderStatus=!1:(this.renderActive=!1,(i=t instanceof w?t.signalList:null)&&i.length||(this.renderStatus=!1),r.renderSubscriber||(r.renderSubscriber=new et),r.renderSubscriber.append(this,i,!1)),e=!1;break}r=r.parent||r.view.renderVirtualNode}return e},clear:function(){if(this.cleared=!0,this.renderStatus=!1,this.node&&(this.node.parentNode&&this.node.parentNode.removeChild(this.node),this.eventListener)){for(var t in this.eventListener)e=this.node,i=t,t=this.eventListener[t],"function"==typeof e.removeEventListener?e.removeEventListener(i,t,!1):"function"==typeof e.detachEvent?e.detachEvent("on"+i,t):e["on"+i]=null;this.eventListener=null}var e,i;this.renderView&&this.renderView.virtualTree.clear(),this.statement&&this.statement.isInvisible()&&this.children.clear(),this.checkSibling()},remove:function(){this.removed=!0,this.clear()}};var Y="~template.statement",Z="~template.id";function tt(t,e){this.virtualNode=this.initializeNew(t,e),this.recycled=new Object}function d(){this.length=0,this.renderStatus=!1}function f(e,i,n,t,r){if(e&&i&&i.isViewRender())if(i.removed||i.failed)i.clear();else if(!(e instanceof u)||e.isRender()&&e.isViewRender()){i.renderListener=function(t){"function"==typeof r?r():(i.checkHeartbeat(t)&&(new f(e,i,n,t,r),i.renderSubscriber)&&i.renderSubscriber.publish(i,t),i.checkSibling())},this.parentNode=e,this.virtualNode=i,this.virtualNode.renderSelector=e,this.virtualNode.cleared=!1,this.index=n,this.publisher=t,this.elementNSRenderListener=r,this.childrenUpdated=!1;try{this.interpret()}catch(s){throw this.virtualNode.failed=!0,s}}else e.renderStatus=!1}tt.prototype={constructor:tt,recycle:function(t){for(;t.length;){var e=t.pop();"undefined"==typeof e.buffer[Z]?e.remove():e.removed||(this.recycled[e.buffer[Z]]=e)}},clean:function(){for(var t in this.recycled)this.recycled[t].remove();this.recycled=new Object},initializeNew:function(e,i){var n,t,r=new u({view:e.view,parent:e,type:e.type,tag:e.tag,content:e.content,templateLocation:e.templateLocation});return r.attribute=e.attribute,r.children=e.children,e.children=new d,e.statement&&(n=!1,(t=new $).copy(e.statement,function(t){return!(i&&0<=i.indexOf(t)||!e.statement.defined(t))&&(n=!0)}),n)&&(r.statement=t),r},build:function(t,e){var i,e=e instanceof E?e:e&&"object"==typeof e?new E(e):null;return"undefined"==typeof this.recycled[t]?(i=this.create(this.virtualNode,this.virtualNode.parent,e)).buffer[Z]=t:(i=this.recycled[t],delete this.recycled[t],this.refresh(i,e)),i},create:function(t,e,i){for(var n=[{virtualNode:t,parentVirtualNode:e}],r=null;n.length;){var s=n.shift(),o=new u({view:s.virtualNode.view,parent:s.parentVirtualNode,type:s.virtualNode.type,tag:s.virtualNode.tag,content:s.virtualNode.content,templateLocation:s.virtualNode.templateLocation});r?s.parentVirtualNode&&s.parentVirtualNode.children.push(o):r=o,s.virtualNode.statement&&(o.statement=new $,o.statement.copy(s.virtualNode.statement),o.buffer[Y]=s.virtualNode.statement),o.attribute=s.virtualNode.attribute,i&&i.deploy(o);for(var a=0;a<s.virtualNode.children.length;a++)n.push({virtualNode:s.virtualNode.children[a],parentVirtualNode:o})}return r},refresh:function(t,e){var i=new Array;for(i.push(t);i.length;){var n=i.shift(),r=n.buffer[Y]||null;r?(n.statement=new $,n.statement.copy(r)):n.statement=null,e&&e.deploy(n);for(var s=0;s<n.children.length;s++)i.push(n.children[s])}}},d.prototype={constructor:d,queryVisibleList:function(){for(var t=new Array,e=0;e<this.length;e++){var i,n=this[e];n.removed||(n.statement&&n.statement.isInvisible()?((i=n.children.queryVisibleList()).length&&(t=t.concat(i)),n.renderView&&n.renderView.virtualTree&&(i=n.renderView.virtualTree.queryVisibleList()).length&&(t=t.concat(i))):t.push(n))}return t},push:function(t){this[this.length]=t,this.length++,t.renderStatus||(this.renderStatus=!1)},pop:function(){var t=this.length-1;if(t<0)return null;this.length--;var e=this[t];return delete this[t],e},indexOf:function(t,e){if(!((e="number"!=typeof e||(e=parseInt(e),isNaN(e))?0:e)<0))for(var i=e;i<this.length;i++)if(t===this[i])return i;return-1},lastIndexOf:function(t,e){var i=this.length-1;if(!((e="number"!=typeof e||(e=parseInt(e),isNaN(e))?i:e)<0||i<e))for(var n=e;0<=n;n--)if(t===this[n])return n;return-1},clear:function(){for(var t=0;t<this.length;t++)this[t].clear()},remove:function(t){if(!((t="number"!=typeof t||(t=parseInt(t),isNaN(t))?0:t)<0)){for(;this.length-1>=t;)this.pop().remove();return this.length}},updateView:function(t){for(var e=0;e<this.length;e++)this[e].updateView(t)},transfer:function(t){for(var e=0;e<this.length;e++){var i=this[e];i.parent=null,i.updateView(t)}}},f.prototype={constructor:f,interpret:function(){if(this.virtualNode.statement){if(this.virtualNode.statement.defined("$before")&&this.$handle(this.virtualNode.statement.$before,y.$before,!0),this.virtualNode.statement.defined("$if")||this.virtualNode.statement.defined("$elseif")||this.virtualNode.statement.defined("$else"))if(!this.$conditional())return void(this.virtualNode.renderStatus=!0);this.virtualNode.statement.defined("$template")&&this.$template()}if(this.virtualNode.statement&&this.virtualNode.statement.defined("$for"))this.$for();else{if(this.virtualNode.statement&&this.virtualNode.statement.defined("$is"))if(!this.$is())return void(this.virtualNode.renderStatus=!0);var t=this.virtualNode.statement&&this.virtualNode.statement.isInvisible(),e=!1;this.virtualNode.node||t||(this.virtualNode.createNode(),e=!!this.virtualNode.node),this.virtualNode.statement&&(e&&this.virtualNode.statement.defined("$node")&&this.$handle(this.virtualNode.statement.$node,y.$node,!1),this.virtualNode.statement.defined("$HTML")?this.$handleHTML(this.virtualNode.statement.$HTML,y.$HTML):this.virtualNode.statement.defined("$text")?this.$handleText(this.virtualNode.statement.$text,y.$text):this.virtualNode.statement.defined("$innerHTML")?this.$handleHTML(this.virtualNode.statement.$innerHTML,y.$innerHTML):this.virtualNode.statement.defined("$innerText")?this.$handleText(this.virtualNode.statement.$innerText,y.$innerText):this.virtualNode.statement.defined("$view")&&this.$view()),t?this.appendChildren(this.parentNode):this.virtualNode.node&&(this.virtualNode.statement&&(this.virtualNode.statement.defined("attribute")&&this.$attribute(),this.virtualNode.statement.defined("id")&&this.$id(),this.virtualNode.statement.defined("class")&&this.$class(),this.virtualNode.statement.defined("style")&&this.$style(),this.virtualNode.statement.defined("event"))&&this.$event(),this.virtualNode.isElementNS()?this.appendChildrenElementNS():this.appendChildren(this.virtualNode.node),this.append())}this.virtualNode.statement&&this.virtualNode.statement.defined("$after")&&this.$handle(this.virtualNode.statement.$after,y.$after,!0),this.virtualNode.renderStatus=!0},context:function(t,e){r.virtualNode&&r.stack.push({virtualNode:r.virtualNode,signalValue:r.signalValue}),t?(r.virtualNode=this.virtualNode,r.signalValue=t):(r.virtualNode=null,r.signalValue=null);var t=undefined,i=undefined;try{t=e()}catch(n){i=n}if(r.virtualNode=null,r.signalValue=null,r.stack.length&&(e=r.stack.pop(),r.virtualNode=e.virtualNode,r.signalValue=e.signalValue),undefined!==i)throw i;return t},isInitialize:function(){return!this.publisher},isSignal:function(t){if(this.isInitialize())return!0;for(var e=0;e<this.publisher.signalList.length;e++)if(0===this.publisher.signalList[e].indexOf(t))return!0;return!this.virtualNode.renderStatus||0<=this.publisher.signalList.indexOf(y.$if)||0<=this.publisher.signalList.indexOf(y.$elseif)||0<=this.publisher.signalList.indexOf(y.$is)},forEach:function(t,e){if(t instanceof Array)for(var i=0;i<t.length;i++)"undefined"==typeof t[i]&&(t[i]=undefined),e(i,i);else if(t instanceof Object){var n=0;for(i in t)t.hasOwnProperty(i)&&(e(i,n),n++)}},callContext:function(t,e,i){var n;return"function"==typeof t?(n=this).context(e,function(){return t.call(n.virtualNode.view.context,i)}):t},conditionalNextSiblingSelect:function(){for(var t=null,e=this.virtualNode.querySibling(),i=this.index+1;i<e.length;i++){var n=e[i];if(n.isElement()){if(n.statement&&n.statement.defined("$elseif")){t=n;break}if(n.statement&&n.statement.defined("$else")){t=n;break}break}}return t},conditionalNextSiblingCheck:function(){var t;this.isInitialize()||(t=this.conditionalNextSiblingSelect())&&(this.virtualNode.renderSubscriber||(this.virtualNode.renderSubscriber=new et),this.virtualNode.renderSubscriber.append(t,[y.$if,y.$elseif],!0))},conditionalPreviousSiblingCheck:function(){try{var t=this.virtualNode.querySibling();if(!t||!t.length||0==this.index)throw null;for(var e=!1,i=this.index-1;0<=i;i--){var n=t[i];if(n.isElement()){if(n.statement&&n.statement.defined("$if")){(n.failed||n.buffer[y.$if])&&(e=!0);break}if(!n.statement||!n.statement.defined("$elseif"))throw null;if(n.failed){e=!0;break}n.buffer[y.$elseif]&&(e=!0)}}return e}catch(r){throw this.virtualNode.statement.defined("$elseif")?new Error(c.make("statement-syntax-elseif-else",y.$elseif)):new Error(c.make("statement-syntax-elseif-else",y.$else))}},queryChildrenLastNode:function(t,e){for(var i=null,n=t.length-1;0<=n;n--){var r=t[n];if(r.statement&&r.statement.isInvisible()){if(i=r.renderView?this.queryChildrenLastNode(r.renderView.virtualTree,e):this.queryChildrenLastNode(r.children,e))break}else if(r.node&&r.node.parentNode===e){i=r.node;break}}return i},queryPreviousSiblingNode:function(t){var e=null;if(this.virtualNode.node!==t)for(var i=new Array,n=this.virtualNode,r=this.index,s=n.querySibling();n;){i.push(n);for(var o=r-1;0<=o;o--){var a=s[o];if(a.statement&&a.statement.isInvisible()){if(e=a.renderView?this.queryChildrenLastNode(a.renderView.virtualTree,t):this.queryChildrenLastNode(a.children,t))break}else if(a.node&&a.node.parentNode===t){e=a.node;break}}if(e)break;if(!(n=n.parent||n.view.renderVirtualNode))break;if(n.node===t)break;if(0<=i.indexOf(n))break;r=(s=n.querySibling()).indexOf(n)}return e},queryVirtualNodeSelector:function(t){for(var e=new Array,i=t,n=undefined;i&&"object"==typeof i;){if(!(i instanceof u)){if(i instanceof HTMLElement){n=i;break}break}if(0<=e.indexOf(i))break;e.push(i),i=i.renderSelector}return n},append:function(){if(this.parentNode instanceof u){if(this.parentNode.node&&this.parentNode.node instanceof HTMLElement)var t=this.parentNode.node;else if(!(t=this.queryVirtualNodeSelector(this.parentNode)))throw new Error(c.make("render-selector"));return this.appendHTMLElement(t)}if(this.parentNode instanceof HTMLElement)return this.appendHTMLElement(this.parentNode)},appendHTMLElement:function(t){var e,i=null,n=this.queryPreviousSiblingNode(t),i=n?n.nextSibling:t.firstChild;if(this.virtualNode.node.parentNode&&(e=!1,t!==this.virtualNode.node.parentNode&&(e=!0),e=!(!n||n===this.virtualNode.node.previousSibling)||e)&&this.virtualNode.node.parentNode.removeChild(this.virtualNode.node),t===this.virtualNode.node.parentNode)return!0;try{return i?t.insertBefore(this.virtualNode.node,i):t.appendChild(this.virtualNode.node),!0}catch(r){throw r}},appendChildren:function(t,e){var i=this.isInitialize();if(i||this.childrenUpdated||!this.virtualNode.children.renderStatus){this.virtualNode.children.renderStatus=!0;for(var n=0;n<this.virtualNode.children.length;n++){var r=this.virtualNode.children[n];!i&&!this.childrenUpdated&&r.renderStatus||(new f(t,r,n,null,e||this.elementNSRenderListener),r.checkSibling())}}},appendChildrenElementNS:function(){var n,r;!this.isInitialize()&&!this.childrenUpdated&&this.virtualNode.children.renderStatus||(n=this,(r=function(){var t=o.createElement("div");if(n.appendChildren(t,r),"undefined"==typeof n.virtualNode.node.innerHTML){for(var e=o.createElement("div"),i=(e.innerHTML="<svg>"+t.innerHTML+"</svg>",e.firstChild);n.virtualNode.node.firstChild;)n.virtualNode.node.removeChild(n.virtualNode.node.firstChild);for(;i.firstChild;)n.virtualNode.node.appendChild(i.firstChild)}else n.virtualNode.node.innerHTML=t.innerHTML})())},$handle:function(t,e,i){for(var n=0;n<t.length;n++){var r=t[n],s=i?e+":"+n:null;i&&!this.isSignal(s)||this.callContext(r,s,new S({name:e,target:this.virtualNode}))}},$conditional:function(){var t,e;return this.virtualNode.renderActive=!1,this.virtualNode.statement.defined("$if")?(t=y.$if,e=this.virtualNode.buffer[t]||!1,this.isSignal(t)&&(e=Boolean(this.callContext(this.virtualNode.statement.$if,t,new S({name:t,target:this.virtualNode})))),this.virtualNode.buffer[t]=e,this.virtualNode.renderActive=e,this.conditionalNextSiblingCheck()):this.virtualNode.statement.defined("$elseif")?(t=y.$elseif,e=this.virtualNode.buffer[t]||!1,this.conditionalPreviousSiblingCheck()?e=!1:this.isSignal(t)&&(e=Boolean(this.callContext(this.virtualNode.statement.$elseif,t,new S({name:t,target:this.virtualNode})))),this.virtualNode.buffer[t]=e,this.virtualNode.renderActive=e,this.conditionalNextSiblingCheck()):this.virtualNode.statement.defined("$else")&&(t=y.$else,e=!1,e=!this.conditionalPreviousSiblingCheck(),this.virtualNode.buffer[t]=e,this.virtualNode.renderActive=e),this.virtualNode.renderActive||this.virtualNode.clear(),this.virtualNode.renderActive},$template:function(){var t,e=y.$template;this.isSignal(e)&&((t="string"!=typeof(t=this.callContext(this.virtualNode.statement.$template,e,new S({name:e,target:this.virtualNode})))?m(t):t)===(this.virtualNode.buffer[e]||"")?this.virtualNode.statement&&this.virtualNode.statement.isInvisible()&&(this.childrenUpdated=!0):(this.childrenUpdated=!0,this.virtualNode.buffer[e]=t,this.virtualNode.children.length&&this.virtualNode.children.remove(),""!==t&&new Ht({view:this.virtualNode.view,model:this.virtualNode.view.model,virtualTree:this.virtualNode.children,parentVirtualNode:this.virtualNode,template:t})))},$for:function(){var r,t,s,o,a,h,l,u,d=y.$for;(this.isSignal(d)||this.childrenUpdated)&&(r=this.virtualNode.buffer[d]||null,this.childrenUpdated||!r?(r=new tt(this.virtualNode,["$for","$template","$if","$elseif","$else"]),this.virtualNode.buffer[d]=r):r.recycle(this.virtualNode.children),t=this.virtualNode.statement.$for[0]||null,(s="function"==typeof t?this.callContext(t,d,new S({name:d,target:this.virtualNode})):t)&&"object"==typeof s&&(o=this.virtualNode.statement.$for[1]||null,a=this.virtualNode.statement.$for[2]||null,h=new Object,l=this.isInitialize(),(u=this).forEach(s,function(t,e){var i=d+":"+e,t=(n="function"==typeof o?u.callContext(o,i,new xt({name:d,target:u.virtualNode,data:s,key:t,index:e,value:s[t]})):o,""===(t=m(t="function"==typeof a?u.callContext(a,i,new xt({name:d,target:u.virtualNode,data:s,key:t,index:e,value:s[t]})):a))?e:t);if(h[t])throw new Error(c.make("render-for-id",t));h[t]=!0;var t=r.build(t,n),n=(u.virtualNode.children.push(t),null);!l&&u.publisher.signalList.indexOf(d)<0&&u.publisher.signalList.indexOf(i)<0&&(n=new w),new f(u.parentNode,t,e,n,u.elementNSRenderListener)})),r.clean())},$is:function(){var t=y.$is,e=this.virtualNode.buffer[t]||!1;return this.isSignal(t)&&(e=Boolean(this.callContext(this.virtualNode.statement.$is,t,new S({name:t,target:this.virtualNode})))),this.virtualNode.buffer[t]=e,this.virtualNode.renderActive=e,this.virtualNode.renderActive||this.virtualNode.clear(),this.virtualNode.renderActive},$handleHTML:function(t,e){this.isSignal(e)&&(t="string"!=typeof(t=this.callContext(t,e,new S({name:e,target:this.virtualNode})))?m(t):t)!==(this.virtualNode.buffer[e]||"")&&(this.virtualNode.buffer[e]=t,this.virtualNode.children.length&&this.virtualNode.children.remove(),this.virtualNode.node&&e===y.$innerHTML?this.virtualNode.node.innerHTML=t:""!==t&&new Ht({view:this.virtualNode.view,virtualTree:this.virtualNode.children,parentVirtualNode:this.virtualNode,template:t}))},$handleText:function(t,e){this.isSignal(e)&&(t="string"!=typeof(t=this.callContext(t,e,new S({name:e,target:this.virtualNode})))?m(t):t)!==(this.virtualNode.buffer[e]||"")&&(this.virtualNode.buffer[e]=t,this.virtualNode.children.length&&this.virtualNode.children.remove(),this.virtualNode.node&&e===y.$innerText?this.virtualNode.node.innerText=t:""!==t&&(e=new u({view:this.virtualNode.view,parent:this.virtualNode,type:_,tag:"#text",content:Q(t),templateLocation:[1,1]}),this.virtualNode.children.push(e)))},$view:function(){var t=y.$view;if(this.isSignal(t)||this.childrenUpdated){this.virtualNode.buffer[t]||(this.virtualNode.buffer[t]=new Object);var e=this.virtualNode.buffer[t].children||null,i=(!this.childrenUpdated&&e||((e=new k({context:this.virtualNode.view.context,model:this.virtualNode.view.model,virtualTree:this.virtualNode.children})).virtualTree.transfer(e),this.virtualNode.buffer[t].children=e,this.virtualNode.children=new d),new Object);for(n in this.virtualNode.attribute)i[n]=this.virtualNode.attribute[n];var n,r=this.virtualNode.buffer[t].attribute||new Object,s=this.virtualNode.statement.attribute;for(n in s){var o=s[n],a=t+":"+n;this.isSignal(a)?i[n]=this.callContext(o,a,new S({name:t,target:this.virtualNode})):i[n]=r[n]}this.virtualNode.buffer[t].attribute=i;e=this.callContext(this.virtualNode.statement.$view,t,new $t({name:t,target:this.virtualNode,children:e,attribute:i}));e instanceof k&&e.render(this.virtualNode)}},$attribute:function(){var t,e=y.attribute,i=("undefined"==typeof this.virtualNode.buffer[e]&&(this.virtualNode.buffer[e]=new Object),this.virtualNode.buffer[e]),n=this.virtualNode.node,r=this.virtualNode.node.nodeName.toLowerCase(),s=this.virtualNode.statement.attribute;for(t in s){var o=s[t],a=e+":"+t;this.isSignal(a)&&(o=this.callContext(o,a,new S({name:e,target:this.virtualNode})),"undefined"!=typeof i[t]&&i[t]===o||(i[t]=o,"input"===r&&("checked"!==t||"checkbox"!==n.type&&"radio"!==n.type?"value"===t&&n.value!==o&&(n.value="string"!=typeof o&&"number"!=typeof o?"":o):n.checked=!!o),"textarea"===r&&"value"===t&&n.value!==o&&(n.value="string"!=typeof o&&"number"!=typeof o?"":o),"option"===r&&"selected"===t&&(n.selected=!!o),a=n.getAttribute(t),!1===o||null===o||o===undefined?null!==a&&n.removeAttribute(t):a!==o&&n.setAttribute(t,o)))}},$id:function(){var t,e=y.id;this.isSignal(e)&&(t="string"!=typeof(t=this.callContext(this.virtualNode.statement.id,e,new S({name:e,target:this.virtualNode})))?m(t):t)!==(this.virtualNode.buffer[e]||"")&&(this.virtualNode.buffer[e]=t,this.virtualNode.node.setAttribute("id",t))},$class:function(){for(var t=y["class"],e=("undefined"==typeof this.virtualNode.buffer[t]&&(this.virtualNode.buffer[t]=new Object),this.virtualNode.buffer[t]),i=this.virtualNode.node,n=i.classList&&v(i.classList.value)&&""!==i.classList.value?i.classList.value.split(/\s+/):new Array,r=this.virtualNode.statement["class"],s=0;s<r.length;s++){var o=r[s],a=t+":"+s;if(this.isSignal(a)){var h=this.callContext(o,a,new S({name:t,target:this.virtualNode}));if("number"==typeof h?h=[m(h)]:v(h)&&(h=h.split(/\s+/g)),h instanceof Array)for(var l=new Object,u=0;u<h.length;u++){var d=h[u];""!==d&&(l[d]=!0)}else l=h&&"object"==typeof h?h:new Object;o=e[s]||null;if(o&&"object"==typeof o)for(var c in o)"undefined"==typeof l[c]&&(l[c]=!1);if((e[s]=l)&&"object"==typeof l)for(var c in l){var f=p(c);""!==f&&(Boolean(l[c])?n.indexOf(f)<0&&n.push(f):0<=(f=n.indexOf(f))&&n.splice(f,1))}}}n.length?this.virtualNode.node.setAttribute("class",n.join(" ")):this.virtualNode.node.removeAttribute("class")},$style:function(){for(var t=y.style,e=("undefined"==typeof this.virtualNode.buffer[t]&&(this.virtualNode.buffer[t]=new Object),this.virtualNode.buffer[t]),i=this.virtualNode.node,n=this.virtualNode.statement.style,r=0;r<n.length;r++){var s=n[r],o=t+":"+r;if(this.isSignal(o)){var a=this.callContext(s,o,new S({name:t,target:this.virtualNode}));if(a&&"object"==typeof a||(a=new Object),(l=e[r]||null)&&"object"==typeof l)for(var h in l)a.hasOwnProperty(h)||(a[h]=l[h]);else var l=new Object;for(h in a){var u=p(h),d=a[h];if(l.hasOwnProperty(u)||(l[u]=i.style[u]),d&&d instanceof Array)for(var c=0;c<d.length&&(i.style[u]=d[c],i.style[u]!==d[c]);c++);else i.style[u]=d}e[r]=l}}""===this.virtualNode.node.getAttribute("style")&&this.virtualNode.node.removeAttribute("style")},$event:function(){var s=y.event;if(this.isSignal(s)){this.virtualNode.buffer[s]=new Object,this.virtualNode.eventListener||(this.virtualNode.eventListener=new Object);var t,i=this.virtualNode.buffer[s],o=this.virtualNode,e=this.virtualNode.statement.event;for(t in e)!function(n,t){var r=n.replace(/^on/,"");if(i[r]=new Array,t&&t instanceof Array)for(var e=0;e<t.length;e++)"function"==typeof t[e]&&i[r].push(t[e]);i[r].length&&!o.eventListener[r]&&(o.eventListener[r]=function(t){var e=o.buffer[s][r]||null;if(e&&e.length)for(var i=0;i<e.length;i++)!1===e[i].call(o.view.context,new Lt({name:n,target:o,event:t}))&&("function"==typeof t.preventDefault?t.preventDefault():t.returnValue=!1)},B(o.node,r,o.eventListener[r]))}(t,e[t])}}};var y={$before:"$before",$after:"$after",$if:"$if",$elseif:"$elseif",$else:"$else",$template:"$template",$for:"$for",$is:"$is",$fragment:"$fragment",$node:"$node",$text:"$text",$HTML:"$HTML",$innerText:"$innerText",$innerHTML:"$innerHTML",$view:"$view",id:"id","class":"class",style:"style",attribute:"attribute",event:"event"},r={virtualNode:null,signalValue:null,stack:new Array};function et(){this.registry=new Array,this.notify=new Array}function b(t,e){this.virtualNode=t,this.signalList=new Array,this.append(e)}function w(t,e){this.signalList=e instanceof Array?e:new Array,t&&"function"==typeof t.renderListener&&t.renderListener(this)}function N(t){this[it]=new nt,Object.defineProperty(this,it,i.readonly);var r=this[it];this.value=t,this.get=function(){return r.subscribe(),this.value},this.set=function(t){return this.value!==t&&(this.value=t,r.publish(this)),this},this.publish=function(){return r.publish(this),this},this.subscribe=function(t,e){var i,n;return"function"==typeof t?(i=K.create(K.type.observerSubscribe),r.custom[i]=t,n=function(){r.custom[i]&&delete r.custom[i]},e&&t(this,n),n):(r.subscribe(),null)},this.clear=function(){r.reactive=new Array,r.custom=new Object}}et.prototype={constructor:et,append:function(e,t,i){var i=i?this.notify:this.registry,n=i.find(function(t){return t&&t.virtualNode===e});n?n.append(t):i.push(new b(e,t))},publish:function(t,e){if(e instanceof w&&!(t.statement&&t.statement.isConditional()&&e.signalList.indexOf(y.$if)<0&&e.signalList.indexOf(y.$elseif)<0&&e.signalList.indexOf(y.$is)<0)){var i=new Array;for(t.renderActive&&t.renderStatus&&(i.push(this.registry),this.registry=new Array),i.push(this.notify),this.notify=new Array;i.length;)for(var n=i.pop(),r=0;r<n.length;r++){var s=n[r];s instanceof b&&new w(s.virtualNode,s.signalList)}}}},b.prototype={constructor:b,append:function(t){if("string"==typeof t)this.signalList.indexOf(t)<0&&this.signalList.push(t);else if(t instanceof Array)for(var e=0;e<t.length;e++)"string"==typeof t[e]&&this.signalList.indexOf(t[e])<0&&this.signalList.push(t[e])},cancel:function(t){for(var e=new Array,i=0;i<this.signalList.length;i++){var n=this.signalList[i];t.indexOf(n)<0&&e.push(n)}this.signalList=e}},w.prototype={constructor:w},N.prototype={constructor:N};var it="[[Observer]]";function nt(){this.dispatch=new Array,this.reactive=new Array,this.custom=new Object}function L(t,e){this.element=t,this.operator=e}function rt(){this.key="",this.value="",this.operator=""}function st(t){this.universal=!1,this.tag="",this.id="",this.classList=new Array,this.attributeList=new Array,this.relationship=null,this.statement=t}function ot(t){this.elementList=new Array,this.sourceCode=t}nt.prototype={constructor:nt,subscribe:function(){var t,e=r.virtualNode,i=r.signalValue;e&&i&&!(e.removed||e.failed||e.cleared)&&e.isViewSignal()&&((t=this.reactive.find(function(t){return t&&t.virtualNode===e}))?t.append(i):this.reactive.push(new b(e,i)),t=this.dispatch.find(function(t){return t&&t.virtualNode===e}))&&t.cancel(i)},publish:function(t){this.dispatch=this.reactive,this.reactive=new Array;for(var e=0;e<this.dispatch.length;e++){var i,n=this.dispatch[e];n&&(this.dispatch[e]=null,i=n.virtualNode,n=n.signalList)&&n.length&&(!i||i.removed||i.failed||i.isViewSignal()&&new w(i,n))}this.dispatch=new Array;for(var r=Object.keys(this.custom),e=0;e<r.length;e++){var s=r[e];"function"==typeof this.custom[s]&&this.custom[s](t,function(t,e){return function(){t.custom[e]&&delete t.custom[e]}}(this,s))}},unsubscribe:function(e){var t=this.reactive.find(function(t){return t&&t.virtualNode===e});t&&(t.signalList=new Array)}},L.prototype={constructor:L,stringify:function(){return this.element.stringify()+this.operator},contains:function(t){if(!t)return!1;var e=null;if(" "===this.operator)for(var i=new Array,n=t.parent;n&&!e&&!(0<=i.indexOf(n));){if(i.push(n),this.element.contains(n)){e=n;break}n=n.parent}else if(">"===this.operator)t.parent&&this.element.contains(t.parent)&&(e=t.parent);else if("+"===this.operator){var r=(s=t.querySibling()).lastIndexOf(t);0<r&&(e=s[r-1])}else if("~"===this.operator){var s=null;s=t.parent?t.parent.children:t.view.virtualTree;for(var o=0;o<s.length;o++){var a=s[o];if(t===a)break;if(this.element.contains(a)){e=a;break}}}return!!e&&this.element.contains(e)&&(!this.element.relationship||this.element.relationship.contains(e))}},rt.prototype={constructor:rt,stringify:function(){var t="";return""!==this.value&&(t=(t+=""===this.operator?"=":this.operator+"=")+'"'+this.value.replace(/(\\|\")/g,"\\$1")+'"'),"["+this.key+t+"]"},contains:function(t){if(!t)return!1;if(""===this.key||!t.attribute.hasOwnProperty(this.key))return!1;t=t.attribute[this.key];if(""===this.operator)return""===this.value||t===this.value;if("string"!=typeof t)return!1;if("~"===this.operator){if(t.split(/\s+/g).indexOf(this.value)<0)return!1}else if("^"===this.operator){if(0!==t.indexOf(this.value))return!1}else if("$"===this.operator){var e=t.length-this.value.length;if(t.indexOf(this.value,e)!==e)return!1}else if("*"===this.operator){if(t.indexOf(this.value)<0)return!1}else if("|"===this.operator&&t.indexOf(this.value+"-")<0&&t!==this.value)return!1;return!0}},st.prototype={constructor:st,stringify:function(){var t="";if(this.universal)t="*";else{if(t+=this.tag,""!==this.id&&(t+="#"+this.id),this.classList.length)for(var e=0;e<this.classList.length;e++)t+="."+this.classList[e];if(this.attributeList.length)for(e=0;e<this.attributeList.length;e++)t+=this.attributeList[e].stringify();this.relationship&&(t=this.relationship.stringify()+t)}return t},contains:function(t){if(!t)return!1;if(!this.universal){if(""!==this.tag&&t.tag.toLowerCase()!==this.tag.toLowerCase())return!1;if(""!==this.id){if(!t.attribute.hasOwnProperty("id"))return!1;if(t.attribute.id!==this.id)return!1}if(this.classList.length){if(!t.attribute.hasOwnProperty("class"))return!1;var e=t.attribute["class"]||"";if(""===e)return!1;for(var i=e.split(/\s+/g),n=0;n<this.classList.length;n++)if(i.indexOf(this.classList[n])<0)return!1}if(this.attributeList.length)for(n=0;n<this.attributeList.length;n++)if(!this.attributeList[n].contains(t))return!1}return!0}},ot.prototype={constructor:ot,contains:function(t,e){return e.contains(t)&&(!e.relationship||e.relationship.contains(t))},deploy:function(r){if(this.elementList.length)for(var t=0;t<this.elementList.length;t++){var s,o=this.elementList[t];this.contains(r,o)&&(r.statement instanceof $||(r.statement=new $),s=this,R(o.statement,function(t,e){try{r.statement.deploy(t,e)}catch(n){r.failed=!0;var i=new Object;throw R(o.statement,function(t,e){"function"==typeof(e=(e=(e=(e=(e=e instanceof N?"[Signal Object]":e)instanceof k?"[View Object]":e)instanceof j?"[Module Object]":e)instanceof E?"[Model Object]":e)instanceof h?"[URL Object]":e)&&(e=e.toString()),i[t]=e}),new Error(c.make("model-selector-deploy",o.stringify(),t,n,s.sourceCode,JSON.stringify(i,null,"\t"),r.templateLocation.join(":"),r.stringify()))}}))}}};var at="universal",ht="tag",lt="id",ut="class",dt="attributeKey",ct="attributeOperator",ft="attributeValue",vt="attributeValueQuot",pt="attributeValueApos",mt="descendantCombinator",gt="childCombinator",yt="adjacentSiblingCombinator",bt="generalSiblingCombinator",wt="comma";function x(t){this.token=t,this.target=""}function Nt(t,e,i){for(this.selector=t,this.statement=i,this.environmentStack=new Array,this.environment=null,this.str="",this.origin=e,this.index=0;this.index<this.origin.length;this.index++)this.str=this.origin.at(this.index),this.environment?this.environment.isClassToken()||this.environment.isIdToken()||this.environment.isTagToken()?this.handleEnvironment():this.environment.isAttributeKeyToken()?this.handleAttributeKeyEnvironment():this.environment.isAttributeValueToken()?this.handleAttributeValueEnvironment():this.environment.isAttributeValueQuotToken()?this.handleAttributeValueQuotEnvironment():this.environment.isAttributeValueAposToken()&&this.handleAttributeValueAposEnvironment():this.createEnvironment();this.environment&&this.finishEnvironment(),this.createSelector()}function $(){this.$before=null,this.$if=null,this.$elseif=null,this.$else=null,this.$template=null,this.$for=null,this.$is=null,this.$fragment=null,this.$node=null,this.$text=null,this.$HTML=null,this.$innerText=null,this.$innerHTML=null,this.$after=null,this.$view=null,this.id=null,this["class"]=null,this.style=null,this.attribute=null,this.event=null}function S(t){this.name=t.name||"#statementProperty",this.target=t.target||null}function Lt(t){this.name=t.name||"#statementEventProperty",this.target=t.target,this.event=t.event}function xt(t){this.name=t.name||"#statementMapProperty",this.target=t.target,this.data=t.data,this.key=t.key,this.index=t.index,this.value=t.value}function $t(t){this.name=t.name||"#statementViewProperty",this.target=t.target,this.children=t.children,this.attribute=t.attribute}function E(t){this.length=0,this.append(t)}function k(t){this.model=t.model instanceof E?t.model:t.model&&"object"==typeof t.model?new E(t.model):null,this.parent=t.parent instanceof k?t.parent:null,this.virtualTree=t.virtualTree instanceof d?t.virtualTree:new d,this.context=t.context&&t.context instanceof Object?t.context:null,this.signalActive=!0,this.renderActive=!0,this.renderStatus=!1,this.renderVirtualNode=null,this.renderSelector=null;t=v(t.template)?t.template:"";""!==t&&new Ht({view:this,model:this.model,virtualTree:this.virtualTree,template:t})}x.prototype={constructor:x,isDescendantCombinatorToken:function(){return mt===this.token},isChildCombinatorToken:function(){return gt===this.token},isAdjacentSiblingCombinatorToken:function(){return yt===this.token},isGeneralSiblingCombinatorToken:function(){return bt===this.token},isCommaToken:function(){return wt===this.token},isClassToken:function(){return ut===this.token},isIdToken:function(){return lt===this.token},isTagToken:function(){return ht===this.token},isAttributeKeyToken:function(){return dt===this.token},isAttributeOperatorToken:function(){return ct===this.token},isAttributeValueToken:function(){return ft===this.token},isAttributeValueQuotToken:function(){return vt===this.token},isAttributeValueAposToken:function(){return pt===this.token}},Nt.prototype={constructor:Nt,attributeOperatorList:["^","$","*","|","~"],isAttributeOperator:function(t){return-1<this.attributeOperatorList.indexOf(t)},relationshipOperatorList:[" ",">","+","~"],isRelationshipOperator:function(t){return-1<this.relationshipOperatorList.indexOf(t)},offset:function(t){this.index=this.index+t},createEnvironment:function(){if(" "===this.str)for(;this.index+1<this.origin.length;){var t=this.origin.at(this.index+1);if(this.isRelationshipOperator(t)){if(this.offset(1),t===this.str)continue;this.str=this.origin.at(this.index)}break}switch(this.str){case",":this.environment=new x(wt),this.finishEnvironment();break;case" ":this.environment=new x(mt),this.environment.target=this.str,this.handleCombinatorEnvironment(),this.finishEnvironment();break;case">":this.environment=new x(gt),this.environment.target=this.str,this.handleCombinatorEnvironment(),this.finishEnvironment();break;case"+":this.environment=new x(yt),this.environment.target=this.str,this.handleCombinatorEnvironment(),this.finishEnvironment();break;case"~":this.environment=new x(bt),this.environment.target=this.str,this.handleCombinatorEnvironment(),this.finishEnvironment();break;case"*":this.environment=new x(at),this.finishEnvironment();break;case".":this.environment=new x(ut);break;case"#":this.environment=new x(lt);break;case"[":this.environment=new x(dt);break;default:this.environment=new x(ht),this.environment.target+=this.str}},finishEnvironment:function(){this.environmentStack.push(this.environment),this.environment=null},handleEnvironment:function(){switch(this.str){case",":case" ":case">":case"+":case"~":case"*":case".":case"#":case"[":this.finishEnvironment(),this.createEnvironment();break;default:this.environment.target+=this.str}},handleCombinatorEnvironment:function(){for(;this.index+1<this.origin.length;){if(" "!==this.origin.at(this.index+1))break;this.offset(1)}},handleAttributeKeyEnvironment:function(){var t=null;if(this.isAttributeOperator(this.str)&&this.index+1<this.origin.length&&"="===this.origin.at(this.index+1)&&((t=new x(ct)).target=this.str,this.offset(1),this.str=this.origin.at(this.index)),"="===this.str){for(var e=null;this.index+1<this.origin.length;){var i=this.origin.at(this.index+1);if("]"===i)break;if(this.offset(1)," "!==i){if('"'===i){e=new x(vt);break}if("'"===i){e=new x(pt);break}(e=new x(ft)).target+=i;break}}e?(this.finishEnvironment(),t&&(this.environment=t,this.finishEnvironment()),this.environment=e):t&&(this.finishEnvironment(),this.environment=t,this.finishEnvironment())}else"]"===this.str?this.finishEnvironment():" "!==this.str&&(this.environment.target+=this.str)},handleAttributeValueEnvironment:function(){"]"===this.str||" "===this.str?this.finishEnvironment():this.environment.target+=this.str},handleAttributeValueQuotEnvironment:function(){'"'===this.str&&this.index+1<this.origin.length&&"]"===this.origin.at(this.index+1)?(this.offset(1),this.finishEnvironment()):"\\"===this.str&&this.index+1<this.origin.length&&("\\"===this.origin.at(this.index+1)||'"'===this.origin.at(this.index+1))?(this.environment.target=this.origin.at(this.index+1),this.offset(1)):this.environment.target+=this.str},handleAttributeValueAposEnvironment:function(){"'"===this.str&&this.index+1<this.origin.length&&"]"===this.origin.at(this.index+1)?(this.offset(1),this.finishEnvironment()):"\\"===this.str&&this.index+1<this.origin.length&&("\\"===this.origin.at(this.index+1)||"'"===this.origin.at(this.index+1))?(this.environment.target=this.origin.at(this.index+1),this.offset(1)):this.environment.target+=this.str},createSelector:function(){for(var t=new Array,e=null;this.environmentStack.length;){var i=this.environmentStack.shift();i.isDescendantCombinatorToken()||i.isChildCombinatorToken()||i.isAdjacentSiblingCombinatorToken()||i.isGeneralSiblingCombinatorToken()?e&&(t.push(new L(e,i.target)),e=null):!i.isCommaToken()&&(e=e||new st(this.statement),i.isAttributeKeyToken()?(e.attributeList.push(new rt),this.backAttribute(e).key=i.target):i.isAttributeOperatorToken()?this.backAttribute(e).operator=i.target:i.isAttributeValueToken()||i.isAttributeValueQuotToken()||i.isAttributeValueAposToken()?this.backAttribute(e).value=i.target:i.isTagToken()?e.tag=i.target:i.isIdToken()?e.id=i.target:i.isClassToken()?e.classList.indexOf(i.target)<0&&e.classList.push(i.target):e=null,this.environmentStack.length)||(e&&(t.push(e),e=null),t.length&&(this.callSelector(t),t=new Array))}},backAttribute:function(t){var e=t.attributeList.length-1;return e<0?new rt:t.attributeList.at(e)},callSelector:function(t){for(var e=null,i=null;t.length;){var n=t.pop(),e=e||(n instanceof L?n.element:n);i&&n instanceof L&&(i.relationship=n),i=n instanceof L?n.element:n}e&&this.selector.elementList.push(e)}},$.prototype={constructor:$,isInvisible:function(){return this.$fragment||this.defined("$for")||this.defined("$HTML")||this.defined("$text")||this.defined("$view")},isConditional:function(){return this.defined("$if")||this.defined("$elseif")||this.defined("$else")||this.defined("$is")},defined:function(t){return!("undefined"==typeof this[t]||"object"==typeof this[t]&&!this[t])},copy:function(t,e){var i,n="function"==typeof e;for(i in t)if(t.hasOwnProperty(i)&&(!n||e(i))){var r=t[i];if(0===i.indexOf("$")){if("$if"===i||"$elseif"===i||"$else"===i||"$for"===i||"$is"===i||"$template"===i||"$text"===i||"$HTML"===i||"$innerText"===i||"$innerHTML"===i||"$view"===i||"$fragment"===i)this[i]=r;else if(t.defined(i)){this[i]||(this[i]=new Array);for(var s=0;s<r.length;s++)this[i].push(r[s])}}else if("event"===i){if(r)for(var o in this.event||(this.event=new Object),r){this.event[o]||(this.event[o]=new Array);for(var a=r[o],s=0;s<a.length;s++)this.event[o].push(a[s])}}else if("style"===i){if(r){this.style||(this.style=new Array);for(s=0;s<r.length;s++)this.style.push(r[s])}}else if("class"===i){if(r){this["class"]||(this["class"]=new Array);for(s=0;s<r.length;s++)this["class"].push(r[s])}}else if("id"===i)this.id=r;else if("attribute"===i&&r)for(var o in this.attribute||(this.attribute=new Object),r)this.attribute[o]=r[o]}},deploy:function(t,e){if(0===t.indexOf("on"))this.event||(this.event=new Object),this.event[t]||(this.event[t]=new Array),this.event[t].push(e);else if(0===t.indexOf("$")){if(!this.hasOwnProperty(t))throw"不支持 "+t+" 命令";if("$if"===t||"$elseif"===t||"$else"===t){if(this.defined("$if")||this.defined("$elseif")||this.defined("$else"))throw"$if | $elseif | $else 三个命令在同一个节点中，只能定义一次";this[t]=e}else if("$for"===t||"$is"===t||"$template"===t){if(this.defined(t))throw t+"“"+t+"” 命令已经定义了，该命令只能定义一次";this[t]=e}else if("$text"===t||"$HTML"===t||"$innerText"===t||"$innerHTML"===t||"$view"===t){if(this.defined("$text")||this.defined("$HTML")||this.defined("$innerText")||this.defined("$innerHTML")||this.defined("$view"))throw"$text | $HTML | $innerText | $innerHTML | $view 四个命令在同一个节点中，只能定义一次";this[t]=e}else"$fragment"===t?this[t]=e:(this[t]||(this[t]=new Array),this[t].push(e))}else"style"===t?(this.style||(this.style=new Array),this.style.push(e)):"id"===t?this.id=e:"class"===t?(this["class"]||(this["class"]=new Array),this["class"].push(e)):(this.attribute||(this.attribute=new Object),this.attribute[t]=e)}},S.prototype={constructor:S},Lt.prototype={constructor:Lt},xt.prototype={constructor:xt},$t.prototype={constructor:$t},E.prototype={constructor:E,append:function(t){if(t instanceof E)for(var e=0;e<t.length;e++)this[n.length]=t[e],this.length++;else{var n=this;R(t,function(t,e){var i;"string"==typeof t&&(i=new ot(t),n[n.length]=i,n.length++,new Nt(i,t,e))})}},deploy:function(t){for(var e=0;e<this.length;e++)this[e].deploy(t)}},k.prototype={constructor:k,render:function(t){var e=null;if(t instanceof u||t instanceof HTMLElement)e=t;else if("string"==typeof t)try{e=o.querySelector(t)}catch(r){}if(e instanceof u&&(e!==this.renderSelector&&(e.renderView instanceof k&&e.renderView!==this&&e.renderView.clear(),this.renderSelector instanceof u)&&this.renderSelector.renderView===this&&(this.renderSelector.renderView=null),(e.renderView=this).renderVirtualNode=e),e){this.renderSelector=e,this.renderStatus=!0,this.virtualTree.renderStatus=!0;for(var i=0;i<this.virtualTree.length;i++){var n=this.virtualTree[i];new f(e,n,i,null,null),n.checkSibling()}}return this},clear:function(){return this.renderStatus=!1,this.virtualTree.clear(),this},HTML:function(){var t="";if(this.renderStatus&&this.virtualTree.length)for(var e=this.virtualTree.queryVisibleList(),i=0;i<e.length;i++)e[i].node&&e[i].node.parentNode&&(e[i].isComment()?t+="\x3c!--"+e[i].node.nodeValue+"--\x3e":e[i].isText()?t+=e[i].node.nodeValue:t+=e[i].node.outerHTML);return t},text:function(){var t="";if(this.renderStatus&&this.virtualTree.length)for(var e=this.virtualTree.queryVisibleList(),i=0;i<e.length;i++)e[i].node&&e[i].node.parentNode&&(e[i].isComment()||(e[i].isText()?t+=e[i].node.nodeValue:t+=e[i].node.innerText));return t}};var St="element",T="singleElement",Et="comment",kt="code",A="text",Tt="elementEnd",At="attributeKey",Ot="attributeValue",Ct="attributeValueQuot",Vt="attributeValueApos";function O(t,e){this.parser=t,this.token=e,this.line=t.line,this.column=t.column-1,this.childEnvironmentList=new Array,this.attributeEnvironmentList=new Array,this.endEnvironment=null,this.target="",this.status=!1,this.endStatus=!1}function Ht(t){for(this.view=t.view instanceof k?t.view:null,this.model=t.model instanceof E?t.model:null,this.virtualTree=t.virtualTree||null,this.parentVirtualNode=t.parentVirtualNode||null,this.origin=t.template,this.environmentStack=new Array,this.environment=null,this.line=1,this.column=1,this.str="",this.index=0;this.index<this.origin.length;this.index++){var e;this.str=this.origin.at(this.index),"\n"===this.str?(this.line++,this.column=1):this.column++,!this.environment&&this.environmentStack.length&&((e=this.environmentStack[this.environmentStack.length-1]).endStatus?(this.environment=this.environmentStack.pop(),this.pushEnvironment()):e.status||(this.environment=this.environmentStack.pop())),this.environment?this.environment.isTextToken()?this.handleTextEnvironment():this.environment.isElementToken()?this.handleElementEnvironment():this.environment.isElementEndToken()?this.handleElementEndEnvironment():this.environment.isCommentToken()?this.handleCommentEnvironment():this.environment.isAttributeKeyToken()?this.handleAttributeKeyEnvironment():this.environment.isAttributeValueToken()?this.handleAttributeValueEnvironment():this.environment.isAttributeValueQuotToken()?this.handleAttributeValueQuotEnvironment():this.environment.isAttributeValueAposToken()&&this.handleAttributeValueAposEnvironment():this.createEnvironment()}this.cleanEnvironment()}function jt(t){this.map=t.map,this.src=t.src,this.type=t.type,this.readyState=0,this.readyWait=new Array,this.value=null,this.error=null,this.module=null}O.prototype={constructor:O,isElementToken:function(){return St===this.token},isSingleElementToken:function(){return T===this.token},isElementEndToken:function(){return Tt===this.token},isCommentToken:function(){return Et===this.token},isCodeToken:function(){return kt===this.token},isTextToken:function(){return A===this.token},isAttributeToken:function(){return At===this.token||Ot===this.token||Ct===this.token||Vt===this.token},isAttributeKeyToken:function(){return At===this.token},isAttributeValueToken:function(){return Ot===this.token},isAttributeValueQuotToken:function(){return Ct===this.token},isAttributeValueAposToken:function(){return Vt===this.token}},Ht.prototype={constructor:Ht,tagIllegalCharList:["/"," ","\n","<",">"],isTagIllegalChar:function(t){return-1<this.tagIllegalCharList.indexOf(t)},elementCodeTagList:["style","script","template"],isElementCodeTag:function(t){return-1<this.elementCodeTagList.indexOf(t.toLowerCase())},isElementEndStart:function(){return"<"===this.str&&this.index+1<this.origin.length&&"/"===this.origin.at(this.index+1)&&this.index+2<this.origin.length&&!this.isTagIllegalChar(this.origin.at(this.index+2))},isElementStart:function(){return"<"===this.str&&this.index+1<this.origin.length&&!this.isTagIllegalChar(this.origin.at(this.index+1))},isCommentStart:function(){return"<"===this.str&&this.index+1<this.origin.length&&"!"===this.origin.at(this.index+1)&&this.index+2<this.origin.length&&"-"===this.origin.at(this.index+2)&&this.index+3<this.origin.length&&"-"===this.origin.at(this.index+3)},offset:function(t){for(var e=1;e<=t;e++)"\n"===this.origin.at(this.index+e)?(this.line++,this.column=1):this.column++;this.index=this.index+t},createEnvironment:function(){this.isElementEndStart()?this.createElementEndEnvironment():this.isCommentStart()?this.createCommentEnvironment():this.isElementStart()?this.createElementEnvironment():(this.environment=new O(this,A),this.handleTextEnvironment())},createElementEnvironment:function(){this.environment=new O(this,St),this.handleElementTagEnvironment()},createElementEndEnvironment:function(){this.environment=new O(this,Tt),this.offset(1),this.handleElementTagEnvironment()},createCommentEnvironment:function(){this.environment=new O(this,Et),this.offset(3)},handleElementEnvironment:function(){var t;"/"===this.str&&this.index+1<this.origin.length&&">"===this.origin.at(this.index+1)?(this.environment.token=T,this.environment.status=!0,this.environment.endStatus=!0,this.offset(1),this.pushEnvironment()):">"===this.str?(this.environment.status=!0,t=this.environment,this.pushEnvironment(),this.handleCodeEnvironment(t)):" "!==this.str&&"\n"!==this.str&&"/"!==this.str&&(this.pushEnvironment(new O(this,At)),this.handleAttributeKeyEnvironment())},handleElementEndEnvironment:function(){">"===this.str?(this.environment.status=!0,this.environment.endStatus=!0,this.pushEnvironment()):" "!==this.str&&"\n"!==this.str&&"/"!==this.str&&(this.pushEnvironment(new O(this,At)),this.handleAttributeKeyEnvironment())},handleElementTagEnvironment:function(){for(var t,e=1;this.index+e<this.origin.length;){var i=this.origin.at(this.index+e);if(" "===i||"\n"===i)break;if("/"===i){e--;break}if(">"===i){this.environment.status=!0,this.environment.isElementEndToken()&&(this.environment.endStatus=!0);break}this.environment.target+=i,e++}this.offset(e),this.environment.status&&(t=this.environment,this.pushEnvironment(),this.handleCodeEnvironment(t))},handleAttributeKeyEnvironment:function(){if("="===this.str&&""!==this.environment.target)for(;this.index+1<this.origin.length;){if(">"===(t=this.origin.at(this.index+1)))break;if(this.offset(1)," "!==t&&"\n"!==t&&"\t"!==t)return'"'===t?(this.environment.status=!0,this.environment.endStatus=!0,void this.pushEnvironment(new O(this,Ct))):"'"===t?(this.environment.status=!0,this.environment.endStatus=!0,void this.pushEnvironment(new O(this,Vt))):(this.environment.status=!0,this.environment.endStatus=!0,this.pushEnvironment(new O(this,Ot)),this.str=this.origin.at(this.index),void this.handleAttributeValueEnvironment())}else if(" "===this.str)for(;this.index+1<this.origin.length;){var t;if(" "!==(t=this.origin.at(this.index+1))&&"\n"!==t&&"\t"!==t){if("="!==t||">"===t)return this.environment.status=!0,this.environment.endStatus=!0,void this.pushEnvironment();break}this.offset(1)}else this.environment.target+=this.str;this.index+1<this.origin.length&&">"!==this.origin.at(this.index+1)&&"/"!==this.origin.at(this.index+1)||(this.environment.status=!0,this.environment.endStatus=!0,this.pushEnvironment())},handleAttributeValueEnvironment:function(){this.environment.target+=this.str,this.index+1<this.origin.length&&" "!==this.origin.at(this.index+1)&&">"!==this.origin.at(this.index+1)&&"/"!==this.origin.at(this.index+1)||(this.environment.status=!0,this.environment.endStatus=!0,this.pushEnvironment())},handleAttributeValueQuotEnvironment:function(){'"'===this.str?(this.environment.status=!0,this.environment.endStatus=!0,this.pushEnvironment()):"\\"===this.str&&this.index+1<this.origin.length&&("\\"===this.origin.at(this.index+1)||'"'===this.origin.at(this.index+1))?(this.environment.target=this.origin.at(this.index+1),this.offset(1)):this.environment.target+=this.str},handleAttributeValueAposEnvironment:function(){"'"===this.str?(this.environment.status=!0,this.environment.endStatus=!0,this.pushEnvironment()):"\\"===this.str&&this.index+1<this.origin.length&&("\\"===this.origin.at(this.index+1)||"'"===this.origin.at(this.index+1))?(this.environment.target=this.origin.at(this.index+1),this.offset(1)):this.environment.target+=this.str},handleAttributeEndEnvironment:function(){this.index+1<this.origin.length&&" "!==this.origin.at(this.index+1)&&">"!==this.origin.at(this.index+1)||(this.environment.status=!0,this.environment.endStatus=!0,this.pushEnvironment())},handleCommentEnvironment:function(){!(this.index+1<this.origin.length)||"-"===this.str&&this.index+1<this.origin.length&&"-"===this.origin.at(this.index+1)&&this.index+2<this.origin.length&&">"===this.origin.at(this.index+2)?(this.environment.status=!0,this.environment.endStatus=!0,this.offset(2),this.pushEnvironment()):(this.environment.target+=this.str,this.index+1<this.origin.length||(this.environment.status=!0,this.environment.endStatus=!0,this.pushEnvironment()))},handleTextEnvironment:function(){this.isElementEndStart()?(this.environment.status=!0,this.environment.endStatus=!0,this.pushEnvironment(),this.createElementEndEnvironment()):this.isCommentStart()?(this.environment.status=!0,this.environment.endStatus=!0,this.pushEnvironment(),this.createCommentEnvironment()):this.isElementStart()?(this.environment.status=!0,this.environment.endStatus=!0,this.pushEnvironment(),this.createElementEnvironment()):(this.environment.target+=this.str,this.index+1<this.origin.length||(this.environment.status=!0,this.environment.endStatus=!0,this.pushEnvironment()))},handleCodeEnvironment:function(t){if(t.isElementToken()&&this.isElementCodeTag(t.target)){for(var e,i="",n=null,r="";this.index+1<this.origin.length;)if(this.offset(1),this.str=this.origin.at(this.index),n)if(r+=this.str,">"===this.str){if(n.target=p(n.target),n.target===t.target){n.status=!0,n.endStatus=!0;break}n=null,i+=r,r=""}else this.index+1<this.origin.length?n.target+=this.str:(n=null,i+=r,r="");else this.isElementEndStart()?(r+=this.str,n=new O(this,Tt),this.offset(1),r+=this.origin.at(this.index)):i+=this.str;""!==i&&((e=new O(this,kt)).target=i,e.status=!0,e.endStatus=!0,t.childEnvironmentList.push(e)),n||((n=new O(this,Tt)).target=t.target),this.environment=n,this.pushEnvironment()}},pushEnvironment:function(t){if(this.environment)if(this.environment.endStatus)if(this.environmentStack.length)if(this.environment.isElementEndToken()){for(var e=new Array,i=null;this.environmentStack.length;){if((i=this.environmentStack.pop()).isElementToken()&&i.target===this.environment.target){this.environmentStack.push(i);break}e.unshift(i),i=null}if(i){i.endEnvironment=this.environment,i.endStatus=!0;for(var n=0;n<e.length;n++){var r=e[n];for(r.token=T,i.childEnvironmentList.push(r);r.childEnvironmentList.length;)i.childEnvironmentList.push(r.childEnvironmentList.shift())}}else this.environmentStack=e}else{i=this.environmentStack[this.environmentStack.length-1];this.environment.isAttributeToken()?(i.isElementToken()||i.isSingleElementToken())&&i.attributeEnvironmentList.push(this.environment):i.isElementToken()&&i.childEnvironmentList.push(this.environment)}else(this.environment.isElementToken()||this.environment.isSingleElementToken()||this.environment.isCommentToken()||this.environment.isTextToken())&&this.createVirtualNode();else this.environmentStack.push(this.environment);this.environment=t||null},cleanEnvironment:function(){var t=null,e=new Array;if(this.environmentStack.length){if((t=this.environmentStack.pop()).isElementEndToken())t=null;else if(e.push(t),!t.endStatus){for(t.token=T,t.status=!0,t.endStatus=!0;t.childEnvironmentList.length;)e.push(t.childEnvironmentList.shift());t=null}for(var i=t?t.childEnvironmentList:e;this.environmentStack.length;){var n=this.environmentStack.shift();if(!n.isElementEndToken()&&(i.push(n),!n.endStatus))for(n.token=T,n.status=!0,n.endStatus=!0;n.childEnvironmentList.length;)i.push(n.childEnvironmentList.shift())}}for(this.environment&&(this.environment.isElementToken()?(this.environment.token=A,this.environment.target="<"+this.environment.target):this.environment.isElementEndToken()?(this.environment.token=A,this.environment.target="</"+this.environment.target):this.environment.isCommentToken()&&(this.environment.token=A,this.environment.target="\x3c!--"+this.environment.target),this.environment.status=!0,this.environment.endStatus=!0,(t?t.childEnvironmentList:e).push(this.environment));e.length;)this.environment=e.shift(),this.createVirtualNode()},createVirtualNode:function(){for(var t=[{parentVirtualNode:this.parentVirtualNode,environmentList:[this.environment]}],e=null;t.length;)for(var i=t.shift(),n=0;n<i.environmentList.length;n++){var r,s=i.environmentList[n];s.isTextToken()&&/^[\n\t\s]{1,}$/.test(s.target)||(r={view:this.view,parent:i.parentVirtualNode,templateLocation:[s.line,s.column]},s.isElementToken()?(r.type=D,r.tag=s.target):s.isSingleElementToken()?(r.type=J,r.tag=s.target):(s.isCommentToken()?(r.type=G,r.tag="#comment"):s.isCodeToken()?(r.type=X,r.tag="#code"):(r.type=_,r.tag="#text"),r.content=s.target),r=new u(r),e?i.parentVirtualNode&&i.parentVirtualNode.children.push(r):e=r,s.attributeEnvironmentList.length&&this.createAttribute(s.attributeEnvironmentList,r),this.model&&this.model.deploy(r),s.childEnvironmentList.length&&t.push({parentVirtualNode:r,environmentList:s.childEnvironmentList}))}e&&this.virtualTree.push(e),this.environment=null},createAttribute:function(t,e){for(var i=new Array;t.length;){var n=t.shift();n.isAttributeKeyToken()?(i.length&&(e.attribute[i[0]]=i[1]||""),i=[n.target]):i.length&&i.push(n.target),!t.length&&i.length&&(e.attribute[i[0]]=i[1]||"")}}},jt.prototype={constructor:jt,ready:function(i,n){this.readyState=2;var r=this,t=function(t){for(r.error=t,r.readyState=4,"function"==typeof n&&n();r.readyWait.length;){var e=r.readyWait.shift();"function"==typeof e&&e(r)}},e=function(t){for(r.value=t,r.readyState=1,"function"==typeof i&&i();r.readyWait.length;){var e=r.readyWait.shift();"function"==typeof e&&e(r)}};if("module"===this.type){var s=document.createElement("script");s.type="text/javascript",s.src=this.src.stringify(),s.onerror=t,s.onload=e,o.head.appendChild(s)}else{if(!C.configuration||!C.configuration.ready)throw new Error("缺少 Include 功能的准备插件");C.configuration.ready(new It({target:this,resolve:e,reject:t}))}}};var C={configuration:null,map:new Object,useInclude:function(t){t&&"object"==typeof t||(t=new Object),C.configuration&&C.configuration.filter&&C.configuration.filter(t);var e,i=t.src instanceof h?t.src:v(t.src)&&!a(t.src)?new h(t.src):null;return i?(e=(t=""===(t=""===(t=v(t.type)&&!a(t.type)?p(t.type):"")&&""!==(e=i.stringify("path"))?p(e.split(".").pop().toLowerCase()):t)?"text":t)+":"+new h(i.stringify("all, !hash"),n.location.href).stringify("all, !hash"),C.map[e]instanceof jt||(C.map[e]=new jt({src:i,type:t,map:e})),C.map[e]):null},configure:function(t){if(C.configuration)throw new Error("不允许重复设置包含配置");C.configuration=new Mt(t||new Object)}};function It(t){this.target=t.target,this.resolve="function"==typeof t.resolve?t.resolve:null,this.reject="function"==typeof t.reject?t.reject:null}function Mt(t){this.filter="function"==typeof t.filter?t.filter:null,this.ready="function"==typeof t.ready?t.ready:null}function Ut(t){if(V.current)throw new Error("不允许重复创建页面");V.current=this,V.configuration=new Pt(t||new Object),V.progress=new zt,V.router=new qt,V.history=new Qt,this.reload=function(){new Rt},this.history=function(){return V.history},this.module=function(){return V.module},V.router.createEventListener(),new Kt({trigger:new H}),new Rt}It.prototype={constructor:It},Mt.prototype={constructor:Mt};var V={current:null,configuration:null,readyState:!(Ut.prototype={constructor:Ut}),module:null,progress:null,increaseProgress:function(){!this.readyState&&this.progress&&this.progress.increase()},completeProgress:function(){!this.readyState&&this.progress&&this.progress.complete()},router:null,history:null,registerHistory:function(t){this.history.change(t)},registerHistoryLog:function(t){var e=this.history.current();e&&e.change(t)}};function Pt(t){this.router=v(t.router)&&"hash"===p(t.router)?"hash":"browser",this.historyLogMaximum=s(t.historyLogMaximum)?parseInt(t.historyLogMaximum):10,this.historyStepMaximum=s(t.historyStepMaximum)?parseInt(t.historyStepMaximum):10}function Rt(){V.progress.state(1),new Jt({trigger:new H}),V.progress.state(2),M.uninstall(),V.progress.state(3),V.readyState=!1,V.module=null,V.progress.state(4);var e=this,t=new H;if(new Bt({trigger:t,load:function(t){V.progress.state(5),t.module instanceof j?e.prepare(t.module):e.include(t.module)}}),!t.executionCount)throw new Error("没有模块监听 onpage 页面事件")}function qt(){this.lastURL=null,this.listening=!1,this.changing=!1}function zt(){this.total=10,this.loaded=0,this.percent=0,this.step=0,this.moduleIncludeSync=0,this.moduleIncludeSyncCompleted=0}function Qt(){this.logList=new Array,this.index=-1}function Ft(t){this.title="",this.path=t,this.stepList=new Array,this.index=-1}function Bt(t){this.name="onpageload",this.module=null,this.load=t.load,this.stopPropagation=function(){t.trigger.listenerList.length=0},t.trigger.createListener(this.name),t.trigger.pushPageLoad(this,this.load)}function Kt(t){this.name="onpagecreate",this.stopPropagation=function(){t.trigger.listenerList.length=0},t.trigger.createListener(this.name),t.trigger.push(this)}function Wt(t){this.name="onpageerror",this.stopPropagation=function(){t.trigger.listenerList.length=0},t.trigger.createListener(this.name),t.trigger.push(this)}function Dt(t){this.name="onpageready",this.stopPropagation=function(){t.trigger.listenerList.length=0},t.trigger.createListener(this.name),t.trigger.push(this)}function Jt(t){this.name="onpageunload",this.stopPropagation=function(){t.trigger.listenerList.length=0},t.trigger.createListener(this.name),t.trigger.push(this)}function Gt(t){this.name="onpageprogress",this.total=t.total,this.loaded=t.loaded,this.percent=t.percent,this.step=t.step,this.stopPropagation=function(){t.trigger.listenerList.length=0},t.trigger.createListener(this.name),t.trigger.push(this)}function _t(t){this.name="onpagechange",this.target=t.target,this.accept=t.accept,this.ignore=t.ignore,this.stopPropagation=function(){t.trigger.listenerList.length=0},t.trigger.createListener(this.name),t.trigger.pushPageUrlChange(this,this.accept)}function Xt(t){this.name="onpageurlchange",this.target=t.target,this.stopPropagation=function(){t.trigger.listenerList.length=0},t.trigger.createListener(this.name),t.trigger.push(this)}function H(){this.executionCount=0,this.listenerList=new Array}function j(t){new(t instanceof j?Zt:te)(this,t)}Pt.prototype={constructor:Pt,isHashRouter:function(){return"hash"===this.router}},Rt.prototype={constructor:Rt,include:function(t){var e,i=null;if(!(i=t?new ne({src:t.src||null,type:"module",clone:t.clone}):i)||!i.include)return this.error();0===i.include.readyState?(e=this,i.include.ready(function(){e.module(i)},function(){e.error()})):2===i.include.readyState?i.include.readyWait.push(function(){e.module(i)}):this.module(i)},module:function(t){var e=t.include.module instanceof j?t.include.module:null;if(!e)return this.error();this.prepare(e,t.clone)},error:function(){var t=new H;if(new Wt({trigger:t}),!t.executionCount)throw new Error("页面模块不存在")},prepare:function(t,e){var i=this;M.prepare(function(){i.finish(e?new j(t):t)})},finish:function(t){V.progress.state(6),new re(V.module=t,{global:M.isGlobalUse(t)}).render(),V.progress.state(7),V.readyState=!0,M.clear(),V.registerHistory(n.location.href),V.progress.state(8),new Dt({trigger:new H}),V.progress.state(9),M.install(),V.progress.state(10)}},qt.prototype={constructor:qt,createEventListener:function(){var t,e,i;this.listening||(this.listening=!0,this.lastURL=new h,t=this,B(n,"hashchange",function(){t.change()}),B(n,"popstate",function(){t.change()}),e=n.history.pushState,n.history.pushState=function(){e.apply(n.history,arguments),t.change()},i=n.history.replaceState,n.history.replaceState=function(){i.apply(n.history,arguments),t.change()})},createAcceptFunction:function(t){var e=this;return function(){e.lastURL=t,e.changing=!1,new Rt}},createIgnoreFunction:function(){var t=this;return function(){n.history.pushState(null,"",t.lastURL.href),t.changing=!1}},change:function(){var t,e,i;this.changing||(this.changing=!0,t=new h,i=(V.configuration.isHashRouter()?(e=new h("/"+this.lastURL.hash.replace(/^[\#\/]+/,"")),i=new h("/"+t.hash.replace(/^[\#\/]+/,"")),e=e.stringify("path"),i):(e=this.lastURL.stringify("path"),t)).stringify("path"),e!==i?new _t({trigger:new H,target:t.href,accept:this.createAcceptFunction(t),ignore:this.createIgnoreFunction()}):this.lastURL.href!==t.href?(this.lastURL=t,V.registerHistoryLog(t.href),this.changing=!1,new Xt({trigger:new H,target:t.href})):this.changing=!1)}},zt.prototype={constructor:zt,increase:function(){this.moduleIncludeSync++},complete:function(){this.moduleIncludeSyncCompleted++,this.moduleIncludeSyncCompleted>this.moduleIncludeSync&&(this.moduleIncludeSyncCompleted=this.moduleIncludeSync),this.state(0)},state:function(t){0<t&&(1===(this.step=t)&&(this.percent=0),1!==t&&6!==t||(this.moduleIncludeSyncCompleted=0,this.moduleIncludeSync=0),this.loaded=t<=5?2*t/this.total:(2*t+80)/this.total),5==this.step&&0<this.moduleIncludeSync&&(t=this.loaded,e=80/this.moduleIncludeSync*this.moduleIncludeSyncCompleted/this.total,e=10/this.total+e,this.loaded=e<t?t:e);var e,t=this.percent;this.percent=Math.floor(this.loaded/this.total*100),t<this.percent&&new Gt({trigger:new H,total:this.total,loaded:this.loaded,percent:this.percent,step:this.step})}},Qt.prototype={constructor:Qt,serialize:function(){return JSON.stringify(this)},unserialize:function(t){var e=JSON.parse(t);if(e&&"object"==typeof e){if(e.logList instanceof Array)for(var i=0;i<e.logList.length;i++){var n=e.logList[i];if(v(n.path)&&!a(n.path)){var r=new Ft(n.path);if(n.stepList instanceof Array)for(var s=0;s<n.stepList.length;s++)r.stepList.push(n.stepList[s]);r.title=n.title;var o=parseInt(n.index);isNaN(o)||o<0||o>r.stepList.length-1?r.index=r.stepList.length?0:-1:r.index=o,this.logList.push(r)}}t=parseInt(e.index);isNaN(t)||t<0||t>this.logList.length-1?this.index=this.logList.length?0:-1:this.index=t}},change:function(e){var i,t,n=new h(e),n=(i=(V.configuration.isHashRouter()?new h("/"+n.hash.replace(/^[\#\/]+/,"")):n).stringify("path"),this.logList.findIndex(function(t){return t.path===i&&(t.change(e),!0)}));n<0?((t=new Ft(i)).change(e),this.logList.length&&this.logList.length-1!==this.index?(this.index++,this.logList.splice(this.index,0,t),this.logList.length>V.configuration.historyLogMaximum&&this.logList.pop()):(this.logList.push(t),this.logList.length>V.configuration.historyLogMaximum&&this.logList.shift(),this.index=this.logList.length-1)):this.index=n},hasBack:function(){return this.logList.length&&0<this.index},hasForward:function(){return this.logList.length&&this.logList.length-1>this.index},hasLast:function(){var t=this.current();return t&&t.hasLast()},hasNext:function(){var t=this.current();return t&&t.hasNext()},current:function(){return this.logList.length&&this.logList[this.index]||null},back:function(t){this.go(-1,t)},forward:function(t){this.go(1,t)},go:function(t,e){t=parseInt(t),isNaN(t)||0===t||(t=this.index+t)<0||t>this.logList.length-1||(t=this.logList[t]||null)&&t.stepList.length&&(t=t.stepList[t.index],"function"==typeof e?e(t):n.history.pushState(null,"",t))},last:function(t){this.step(-1,t)},next:function(t){this.step(1,t)},step:function(t,e){var i;t=parseInt(t),isNaN(t)||0===t||!(i=this.current())||(t=i.index+t)<0||t>i.stepList.length-1||(t=i.stepList[t],"function"==typeof e?e(t):n.history.pushState(null,"",t))}},Ft.prototype={constructor:Ft,change:function(t){this.title=o.title;var e=this.stepList.indexOf(t);e<0?this.stepList.length&&this.stepList.length-1!==this.index?(this.index++,this.stepList.splice(this.index,0,t),this.stepList.length>V.configuration.historyStepMaximum&&this.stepList.pop()):(this.stepList.push(t),this.stepList.length>V.configuration.historyStepMaximum&&this.stepList.shift(),this.index=this.stepList.length-1):this.index=e},hasLast:function(){return this.stepList.length&&0<this.index},hasNext:function(){return this.stepList.length&&this.stepList.length-1>this.index}},Bt.prototype={constructor:Bt},Kt.prototype={constructor:Kt},Wt.prototype={constructor:Wt},Dt.prototype={constructor:Dt},Jt.prototype={constructor:Jt},Gt.prototype={constructor:Gt},_t.prototype={constructor:_t},Xt.prototype={constructor:Xt},H.prototype={constructor:H,createListener:function(t,e){if(e instanceof j)this.register(t,e);else{var i=new Array;V.module&&i.push(this.register(t,V.module));for(var n=0;n<M.useUninstallList.length;n++)i.indexOf(M.useUninstallList[n])<0&&i.push(this.register(t,M.useUninstallList[n]));for(n=0;n<M.useInstallList.length;n++)i.indexOf(M.useInstallList[n])<0&&i.push(this.register(t,M.useInstallList[n]));for(n=0;n<M.globalUseList.length;n++)i.indexOf(M.globalUseList[n])<0&&i.push(this.register(t,M.globalUseList[n]))}},register:function(t,e){var i,n,r,s=e[I];return"function"==typeof s[t]&&(i=this).listenerList.push((n=e,r=s[t],function(){return i.executionCount++,r.apply(n,arguments)})),e},push:function(t){for(;this.listenerList.length;)this.listenerList.shift()(t)},pushPageLoad:function(t,e){var i;(this.listenerList.length?(i=this,t.load=function(){i.pushPageLoad(t,e)},this.listenerList.shift()):e)(t)},pushPageUrlChange:function(t,e){var i;this.listenerList.length?(i=this,t.accept=function(){i.pushPageUrlChange(t,e)},this.listenerList.shift()(t)):e()}},j.prototype={constructor:j};var I="[[Handler]]";function Yt(t){this.src=e(),this.$shadow=!1,this.$abstract=!1,this.$nonblock=!1,this.$construct="function"==typeof t?t:null,this.$selector=null,this.$template=null,this.$model=null,this.$include=new Array,this.onready=null,this.oninstall=null,this.onuninstall=null,this.onrender=null,this.onrenderready=null,this.onpageload=null,this.onpagecreate=null,this.onpageerror=null,this.onpageprogress=null,this.onpageready=null,this.onpageunload=null,this.onpagechange=null,this.onpageurlchange=null,this.model=null,this.view=null,Object.preventExtensions(this)}Yt.prototype={constructor:Yt};var M={createList:new Array,createWait:new Array,prepare:function(t){return M.createList.length?(M.createWait.push(t),!1):(t(),!0)},clearRenderList:new Array,globalUseList:new Array,useInstallList:new Array,useUninstallList:new Array,isGlobalUse:function(t){return 0<=this.globalUseList.indexOf(t)},use:function(t,e){e?this.globalUseList.indexOf(t)<0&&(this.globalUseList.push(t),0<=(e=this.useUninstallList.indexOf(t))?this.useUninstallList.splice(e,1):this.useInstallList.indexOf(t)<0&&this.useInstallList.push(t)):0<=(e=this.globalUseList.indexOf(t))?(this.globalUseList.splice(e,1),this.useInstallList.indexOf(t)<0&&this.useUninstallList.push(t)):this.useUninstallList.indexOf(t)<0&&this.useInstallList.indexOf(t)<0&&this.useInstallList.push(t),this.install()},install:function(){if(V.readyState){var t=this.useInstallList;this.useInstallList=new Array;for(var e=0;e<t.length;e++){var i=t[e];new oe({trigger:new H,module:i}),this.isGlobalUse(i)||this.useUninstallList.push(i)}}},uninstall:function(){var t=this.useUninstallList;this.useUninstallList=new Array;for(var e=0;e<t.length;e++){var i=t[e],n=(new ae({trigger:new H,module:i}),i[I]);n.view&&n.view.renderStatus&&(this.clearRenderList.push(i),n.view.signalActive=!1,n.view.renderActive=!1)}},registerRender:function(t){t=this.clearRenderList.indexOf(t);0<=t&&this.clearRenderList.splice(t,1)},clear:function(){var t=this.clearRenderList;this.clearRenderList=new Array;for(var e=0;e<t.length;e++){var i=t[e][I];i.view&&i.view.clear()}}};function Zt(t,e){this.originHandler=e[I];e=new Yt(this.originHandler.$construct),this.moduleHandler=e,this.module=t,this.module[I]=e,Object.defineProperty(this.module,I,i.readonly),t=this.moduleHandler.$construct?this.moduleHandler.$construct.call(this.module):new Object;this.moduleHandler.$nonblock=Boolean(t.$nonblock),this.moduleHandler.$shadow=!0,this.moduleHandler.$abstract=!1,new ee(this.module,t),new ie(this.module)}function te(t,e){this.moduleHandler=new Yt(e),this.module=t,this.module[I]=this.moduleHandler,Object.defineProperty(this.module,I,i.readonly),this.includeJavascripts=new Object,this.includeSyncs=new Object,this.includeState=!1;e=this.moduleHandler.$construct?this.moduleHandler.$construct.call(this.module):new Object;this.moduleHandler.$nonblock=Boolean(e.$nonblock),this.moduleHandler.$abstract=Boolean(e.$abstract),this.moduleHandler.$nonblock||M.createList.push(this),e.$shadow?this.moduleHandler.$shadow=!0:(this.moduleHandler.$shadow=!1,this.register()),new ee(this.module,e),this.include()}function ee(t,e){var i;this.module=t,this.moduleHandler=this.module[I],this.moduleHandler.$abstract?"undefined"!=typeof e.$include&&this.initializeInclude(e.$include):(i=this,R(e,function(t,e){0===t.indexOf("$")?"$include"===t?i.initializeInclude(e):"$model"===t?i.initializeModel(e):"$selector"===t?i.initializeSelector(e):"$template"===t&&i.initializeTemplate(e):0===t.indexOf("on")?i.initializeEvent(t,e):i.module[t]=e})),Object.preventExtensions(this.module)}function ie(t){this.module=t,this.moduleHandler=this.module[I],this.templateQueues=new Object,this.moduleHandler.$abstract||(this.detachInclude(),this.createModel(),this.createView(),new se({trigger:new H,module:this.module}))}function ne(t){this.index=s(t.index)?t.index:null,this.use="function"==typeof t.use?t.use:null,this.clone=Boolean(t.clone),this.selector="string"!=typeof t.selector||a(t.selector)?null:t.selector,this.include=C.useInclude(t),this.include&&(this.wait=Boolean(t.wait),"template"!==this.include.type&&"module"!==this.include.type||(this.wait=!0))}function re(t,e){var i=t[I];if(i.$abstract)throw new Error("抽象模块不能被使用 "+i.src);this.target=t,this.global=Boolean(e&&e.global),M.use(this.target,this.global)}function se(t){this.name="onready",t.trigger.createListener(this.name,t.module),t.trigger.push(this)}function oe(t){this.name="oninstall",t.trigger.createListener(this.name,t.module),t.trigger.push(this)}function ae(t){this.name="onuninstall",t.trigger.createListener(this.name,t.module),t.trigger.push(this)}function he(t){this.name="onrender",this.selector=t.selector,this.children=t.children,this.attribute=t.attribute,t.trigger.createListener(this.name,t.module),t.trigger.push(this)}function le(t){this.name="onrenderready",t.trigger.createListener(this.name,t.module),t.trigger.push(this)}function U(){this.currentSrc=e,this.configureInclude=function(t){C.configure(t)},this.createPage=function(t){return new Ut(t)},this.isPage=function(t){return t instanceof Ut},this.currentPage=function(){return V.current},this.createModule=function(t){return new j(t)},this.isModule=function(t){return t instanceof j},this.useModule=function(t,e){if("function"!=typeof t)return new re(t,e);M.prepare(t)},this.createURL=function(t,e){return new h(t,e)},this.isURL=function(t){return t instanceof h},this.createView=function(t){return new k(t)},this.isView=function(t){return t instanceof k},this.createModel=function(t){return new E(t)},this.isModel=function(t){return t instanceof E},this.createSignal=function(t){return new N(t)},this.isSignal=function(t){return t instanceof N},this.HTMLEncode=Q,this.HTMLDecode=F,this.URLEncode=g,this.URLDecode=l,this.URLQueryEncode=q,this.URLQueryDecode=z,this.defineLanguage=function(t){c.define(t)},this.makeLanguage=function(){return c.make.apply(c,arguments)},this.setPrototype=function(t,e){return U.prototype[t]=e,this},this.getPrototype=function(t){return U.prototype[t]||null},Object.preventExtensions(this)}Zt.prototype={constructor:Zt},te.prototype={constructor:te,register:function(){var t=C.useInclude({src:this.moduleHandler.src,type:"module"});if(t.module)throw new Error(t.map+" 模块创建异常，在一个模块文件中只能创建一个非影子模块对象");t.module=this.module,0===t.readyState&&(t.readyState=1)},include:function(){if(this.moduleHandler.$include.length){for(var t=new Array,e=new Object,i=0;i<this.moduleHandler.$include.length;i++){var n,r=this.moduleHandler.$include[i];this.includeRegister(r),(s(r.index)?(e[n=r.index]||(e[n]=new Array),e[n]):t).push(r)}for(i=0;i<t.length;i++)!function(t,e){t.includeReady(e,function(){t.includeCheck(e)})}(this,t[i]);this.includeQueue(e)}else this.includeState=!0,this.ready()},includeRegister:function(t){var e=t.include.map;t.wait&&("js"===t.include.type||"module"===t.include.type?this.includeJavascripts[e]=t:this.includeSyncs[e]=t,V.increaseProgress())},includeQueue:function(t){var e=Object.keys(t);if(e.length){e.sort(function(t,e){return t-e});for(var i=new Array,n=0;n<e.length;n++)for(var r=t[e[n]];r.length;)i.push(r.shift());this.includeRecursive(i)}},includeRecursive:function(t){var e=t.shift(),i=this;this.includeReady(e,function(){i.includeCheck(e),t.length&&i.includeRecursive(t)})},includeReady:function(t,e){return 0===t.include.readyState?t.include.ready(e,e):2!==t.include.readyState?e():void t.include.readyWait.push(e)},includeCheck:function(t){this.includeState||(t=t.include.map,this.includeJavascripts[t]&&(delete this.includeJavascripts[t],V.completeProgress()),this.includeSyncs[t]&&(delete this.includeSyncs[t],V.completeProgress()),P(this.includeJavascripts)&&P(this.includeSyncs)&&(this.includeState=!0,this.ready()))},ready:function(){if(new ie(this.module),!this.moduleHandler.$nonblock){var t=M.createList.indexOf(this);if(M.createList.splice(t,1),!M.createList.length)for(;M.createWait.length;)M.createWait.pop()()}}},ee.prototype={constructor:ee,initializeInclude:function(t){for(var e=t instanceof Array?t:[t],i=0;i<e.length;i++){if("string"==typeof e[i]||e[i]instanceof h)var n={src:e[i]};else{if(!e[i]||"object"!=typeof e[i])continue;n=e[i]}var r=new ne(n);r.include&&this.moduleHandler.$include.push(r)}},initializeModel:function(t){("function"==typeof t||t instanceof E||t&&"object"==typeof t)&&(this.moduleHandler.$model=t)},initializeSelector:function(t){(t instanceof u||t instanceof HTMLElement||"string"==typeof t)&&(this.moduleHandler.$selector=t)},initializeTemplate:function(t){"string"!=typeof t&&"number"!=typeof t||(this.moduleHandler.$template=m(t))},initializeEvent:function(t,e){"function"==typeof e&&this.moduleHandler.hasOwnProperty(t)&&(this.moduleHandler[t]=e)}},ie.prototype={constructor:ie,detachInclude:function(){for(var t=new Object,e=0;e<this.moduleHandler.$include.length;e++){var i,n,r=this.moduleHandler.$include[e];"template"===r.include.type&&v(r.include.value)&&(i=s(r.index)?r.index:0,this.templateQueues[i]=r.include.value),r.use&&("module"===r.include.type?((i=r.include.module)instanceof j&&(r.clone&&(i=new j(i)),"string"==typeof r.selector)&&(n=function(e,i){return function(t){new re(i,{global:M.isGlobalUse(e)}).render({selector:t.target,children:t.children,attribute:t.attribute})}}(this.module,i),t[r.selector]={$view:n}),r.use.call(this.module,i)):r.use.call(this.module,r.include.value))}P(t)||(this.moduleHandler.model=new E(t))},createModel:function(){var t;(t="function"==typeof this.moduleHandler.$model?this.moduleHandler.$model.call(this.module):this.moduleHandler.$model)&&"object"==typeof t&&(this.moduleHandler.model?this.moduleHandler.model.append(t):this.moduleHandler.model=new E(t))},createView:function(){var t=null,e=Object.keys(this.templateQueues);if(e.length){e.sort(function(t,e){return parseFloat(e)-parseFloat(t)});for(var t="",i=0;i<e.length;i++)t+=this.templateQueues[e[i]]}v(this.moduleHandler.$template)&&(t=v(t)?this.moduleHandler.$template+t:this.moduleHandler.$template),v(t)&&""!==t&&(this.moduleHandler.view=new k({template:t,model:this.moduleHandler.model,context:this.module}))}},ne.prototype={constructor:ne},re.prototype={constructor:re,render:function(t){M.registerRender(this.target);var e=this.target[I],i=t&&t.selector?t.selector:e.$selector;new he({trigger:new H,module:this.target,selector:i,children:t&&t.children instanceof k?t.children:null,attribute:t&&"object"==typeof t.attribute?t.attribute:null}),e.view&&(e.view.signalActive=!0,e.view.renderActive=!0,i)&&e.view.render(i),new le({trigger:new H,module:this.target})}},se.prototype={constructor:se},oe.prototype={constructor:oe},ae.prototype={constructor:ae},he.prototype={constructor:he},le.prototype={constructor:le},U.prototype={constructor:U,version:t,author:"a@astarhan.net",js:"webapp.js v1.0.0 是面向模板与交互分离, 基于 ECMAScript 5 特性的单页应用 (SPA) 框架。",includes:C.map},Object.defineProperties(U.prototype,{version:i.readonly,author:i.readonly,js:i.readonly,includes:i.readonly}),n.webapp=new U}(window,document,"1.0.0");